<% if flash[:success].present? %>
  void function () {
    const html = "<%= escape_javascript(render partial: 'usage_limit', locals: { usage_limit: @usage_limit }).html_safe %>";
    const count = "<%= @usage_limit.metric.usage_limits.where(plan_id: @plan.id).count %>";
    const id = "#limits_counter_" + "<%= @usage_limit.metric.to_param  %>";

    jQuery('#usage_limits_table_body').append(html);
    jQuery(id).html(count);
  }();

  jQuery.colorbox.close();
<% else %>
  <%= render 'error' %>
<% end %>

<%= render 'shared/flash_alerts' %>
