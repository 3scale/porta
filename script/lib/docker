# Helper functions for setting up Docker tailored to this project

# lower lever functions
launch_redis()
{
    redis-server /etc/redis/redis.conf
}

launch_memcached()
{
    memcached -u `whoami` &
}

launch_squid()
{
  squid3
}

launch_dnsmasq()
{
    local SUDO=$(which sudo 2> /dev/null)
    ${SUDO} dnsmasq --no-resolv --listen-address=127.0.0.1 \
                    --address=/${DNSMASQ="#"}/127.0.0.1 \
                    --server=/raw.githubusercontent.com/8.8.8.8 \
                    --server=/cc-3scale-amend.herokuapp.com/8.8.8.8 \
                    --user=$(whoami)
}

docker_launch_servers()
{
    launch_redis
    launch_memcached
    launch_dnsmasq
    launch_squid
}

docker_bundler()
{
    bundler --jobs `grep -c processor /proc/cpuinfo`
}

docker_db_prepare()
{
    rake db:create db:schema:load db:test:prepare
}
