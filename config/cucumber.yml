<% std_opts = "--strict --tags ~@wip #{ENV['CUCUMBER_OPTIONS']}" %>
default: <%= std_opts %>
<% tags = %w[ @backend @emails @stats @no-txn ] %>
list: --dry-run --format Cucumber::Formatter::List
ci: --profile default --backtrace --strict --verbose --format junit --out tmp/junit/cucumber --format progress
txn: --profile default --tags=~@javascript <%= tags.map { |tag| "--tags=~#{tag}" }.join(' ') %>
no-txn: --profile default --tags=~@javascript --tags=<%= tags.join(',') %>
javascript: --profile default --tags=~@ignore --tags=@javascript

<%#
#rerun = File.file?('rerun.txt') ? IO.read('rerun.txt') : ""
#rerun = rerun.strip.gsub /\s/, ' '
#rerun_opts = rerun.empty? ? "--format #{ENV['CUCUMBER_FORMAT'] || 'progress'} features" : "--format #{ENV['CUCUMBER_FORMAT'] || 'pretty'} #{rerun}"
#std_opts = "--format #{ENV['CUCUMBER_FORMAT'] || 'pretty'} --strict --tags 'not @wip'"
%>

#default: <%#= std_opts %> features
#wip: --tags @wip:3 --wip features
#rerun: <%#= rerun_opts %> --format rerun --out rerun.txt --strict --tags 'not @wip'
#visual: -b --tags=@percy
